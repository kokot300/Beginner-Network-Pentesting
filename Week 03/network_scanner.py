#!/usr/bin/python3

import sys
import socket
from datetime import datetime

#define target
if len(sys.argv)==2:
    target=socket.gethostbyname(sys.argv[1]) #translate host name to IPv4
else:
    print('invalid amount of args')
    print('syntax: python3 network_scanner.py <ip>')
    sys.exit()

print('-'*50)
print(f'Scanning target {target}')
print(f'Scan started at {datetime.now()}')
print('-'*50)

try:
    for port in range(500000):
        s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        socket.setdefaulttimeout(1) # float
        result=s.connect_ex((target,port)) # returns error indicator
        if result == 0:
            print(f'port {port} is opened')
        s.close()
        #else:
        #    print(f'port {port} is closed')
except KeyboardInterrupt:
    print('exiting\n')
    sys.exit()
except socket.gaierror:
    print('unable to resolve host')
    sys.exit()
except socket.error:
    print('unable connect to server')
    sys.exit()
    
print(f'Scan finished at {datetime.now()}')

